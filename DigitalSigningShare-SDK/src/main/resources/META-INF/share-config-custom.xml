<alfresco-config>

	<!-- Document Library Custom Code config section -->
	<config evaluator="string-compare" condition="DocLibCustom">
		<!-- paramedit dependencies -->
		<dependencies>
			<css src="/components/documentlibrary/sign-action.css" />
			<js src="/components/documentlibrary/sign-action.js" />
			<css src="/components/documentlibrary/signsimple-action.css" />
			<js src="/components/documentlibrary/signsimple-action.js" />
		</dependencies>
	</config>
	
	<!-- Document Library config section -->
    
   	<config evaluator="string-compare" condition="DocumentLibrary" replace="true">

		<indicators>
			<indicator id="signed-doc" index="10" label="indicator.signed">
		    	<evaluator>evaluator.doclib.indicator.digitalSigning.signedDoc</evaluator>
			</indicator>
		</indicators>
		
		<multi-select>
         	<action type="action-link" id="onActionSign" label="menu.selected-items.sign" />
          	<action type="action-link" id="onActionSignSimple" label="menu.selected-items.signsimple" />
      	</multi-select>
      	 <!--
            Used by "Manage Rules" -> "Add aspect" action.
        
            If an aspect has been specified without a title element in the content model,
            or you need to support multiple languages,
            then an i18n file is needed on the Repo AMP/JAR extension side for the aspect to
            be visible when creating rules:
        
               custom_customModel.aspect.custom_myaspect.title=My Aspect
        
            Used by the "Manage Aspects" action.
        
            For the aspect to have a localised label add relevant i18n string(s) in a Share AMP/JAR extension:
        
            	aspect.custom_myaspect=My Aspect
         -->          
      	 <aspects>
      	    <!-- Aspects that a user can see -->
            <visible>
            	<!-- custom aspects -->
                <aspect name="dgtsgn:signed"/>
                <aspect name="dgtsgn:key" /> 
                <aspect name="dgtsgn:image" /> 
                <aspect name="dgtsgn:originalDoc" /> 
            </visible>
            <addable> <!-- defaults to visible config if empty -->
            </addable>
            <removeable> <!-- defaults to visible config if empty -->
            </removeable>
        </aspects>
	</config>

	<!-- Document Library Actions config section -->
	  
	<config evaluator="string-compare" condition="DocLibActions">	
		<actions>
         	<action id="sign" type="javascript" icon="sign" label="actions.sign">
            	<param name="function">onActionSign</param>
            	<permissions>
               		<permission allow="true">Write</permission>
            	</permissions>
            	<evaluator>evaluator.doclib.action.digitalSigning.canSign</evaluator>
            	<evaluator negate="true">evaluator.doclib.indicator.digitalSigning.signedDoc</evaluator>
         	</action>
       		<action id="signsimple" type="javascript" icon="sign" label="actions.signsimple">
            	<param name="function">onActionSignSimple</param>
            	<permissions>
               		<permission allow="true">Write</permission>
            	</permissions>
            	<evaluator>evaluator.doclib.action.digitalSigning.canSign</evaluator>
            	<evaluator negate="true">evaluator.doclib.indicator.digitalSigning.signedDoc</evaluator>
         	</action>
		</actions>
		
		<actionGroups>
			<actionGroup id="document-browse">
				<action index="120" id="sign" />
			</actionGroup>

			<actionGroup id="document-details">
				<action index="120" id="sign" />
			</actionGroup>
			<actionGroup id="document-browse">
				<action index="120" id="signsimple" />
			</actionGroup>

			<actionGroup id="document-details">
				<action index="120" id="signsimple" />
			</actionGroup>
		</actionGroups>
	</config>
	
	<config evaluator="aspect" condition="dgtsgn:signed"> 
		<forms>
       		<form>
	            <field-visibility>
	            	<show id="dgtsgn:signedby" for-mode="view"/>
					<show id="dgtsgn:signaturedate" for-mode="view"/> 
					<show id="dgtsgn:location" for-mode="view"/> 
					<show id="dgtsgn:reason" for-mode="view"/> 
					<show id="dgtsgn:validity" for-mode="view"/>
				</field-visibility> 
				<appearance>
					<field id="dgtsgn:signedby" label-id="prop.dgtsgn_signedby" />
					<field id="dgtsgn:signaturedate" label-id="prop.dgtsgn_signaturedate" /> 
					<field id="dgtsgn:location" label-id="prop.dgtsgn_location" /> 
					<field id="dgtsgn:reason" label-id="prop.dgtsgn_reason" /> 
					<field id="dgtsgn:validity" label-id="prop.dgtsgn_validity" />
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="aspect" condition="dgtsgn:key"> 
		<forms>
       		<form>
	            <field-visibility>
	            	<show id="dgtsgn:keyType" for-mode="view"/>
					<show id="dgtsgn:keyAlias" for-mode="view"/> 
					<show id="dgtsgn:keySubject" for-mode="view"/> 
					<show id="dgtsgn:keyFirstValidity" for-mode="view"/> 
					<show id="dgtsgn:keyLastValidity" for-mode="view"/>
					<show id="dgtsgn:keyAlgorithm" for-mode="view"/>
				</field-visibility> 
				<appearance>
					<field id="dgtsgn:keyType" label-id="prop.dgtsgn_keyType" />
					<field id="dgtsgn:keyAlias" label-id="prop.dgtsgn_keyAlias" /> 
					<field id="dgtsgn:keySubject" label-id="prop.dgtsgn_keySubject" /> 
					<field id="dgtsgn:keyFirstValidity" label-id="prop.dgtsgn_keyFirstValidity" /> 
					<field id="dgtsgn:keyLastValidity" label-id="prop.dgtsgn_keyLastValidity" />
					<field id="dgtsgn:keyAlgorithm" label-id="prop.dgtsgn_keyAlgorithm" />
				</appearance>
			</form>
		</forms>
	</config>
	
	<config evaluator="aspect" condition="dgtsgn:originalDoc">
      <forms>
         <form>
            <field-visibility>
	           	<show id="dgtsgn:relatedDocList" for-mode="view"/>
			</field-visibility> 
			<appearance>
				<field id="dgtsgn:relatedDocList" label-id="prop.dgtsgn_relatedDocType">
					<control template="/org/alfresco/components/form/controls/association.ftl">
						<control-param name="displayMode">items</control-param>
						<control-param name="showTargetLink">true</control-param>
						<control-param name="allowNavigationToContentChildren">true</control-param>
					</control>
				</field>
			</appearance>
         </form>
      </forms>
    </config>

</alfresco-config>